A=9015142898590576196826707258334172044464234843523229626789532087692097764472817093699259614093128952968162718847943242735786840270773651324155081699567823
B=9015142898590576196826707258334172044464234843523229626789532087692097764472817093699259614093128952968162718847943242735786840270773651324155081699533304

from gmpy2 import *
from Crypto.Util.number import *
from sympy import *

s=-1
for i in range(B+1,A):
    s=(s*invert(i,A))%A

p=prevprime(s)
print(p)
c2=3816936947894360775597668534831397825191878510519645944332850933093609750685073647327948704609814945696325104925269030687891681867641260551706374705371536
c1=722936464747447159290940039484482900182128056996464164556643104608584815064763046843746689628444517699022022095341617433509062133657977506062424825685032
e=65537
d=invert(e,p-1)
flag1=long_to_bytes(pow(c1,int(d),p))
print(flag1)
print(long_to_bytes(104975332307745))
# sage
g=2
G=GF(p)
g=G(g)
c2=G(c2)
m=discrete_log_lambda(c2,g,(2**45,2**48))
flag2=long_to_bytes(m)

print(flag1+flag2)